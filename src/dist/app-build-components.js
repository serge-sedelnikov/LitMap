"bundle";!function(){var a=System.amdDefine;a("components/details.html!github:systemjs/plugin-text@0.0.4.js",[],function(){return'<template> <require from="../elements/closeInfo"></require> <div class="page-content"> <div> <div class="col-md-3"> <div class="section"> <h5 t="details.closeToThisPlace"></h5> <hr> <close-info class="info-tile" repeat.for="i of closeInfos" data.bind="i" details.bind="currentDetails"></close-info> </div> </div> <div class="col-md-6 data" id="data"> <div class="section" innerHTML.bind="data"></div> </div> <div class="col-md-3"> <div class="section"> <h5 t="details.alsoInteresting"></h5> <hr> </div> </div> <div class="col-md-6 col-md-offset-3"> <div class="section"> <div id="mc-container"></div> </div> </div> </div> </div> </template>'})}(),System.register("components/details.js",["fetch","aurelia-fetch-client","aurelia-framework","aurelia-i18n","lodash"],function(a){"use strict";var b,c,d,e,f;return{setters:[function(a){},function(a){b=a.HttpClient},function(a){c=a.inject},function(a){d=a.I18N},function(a){e=a["default"]}],execute:function(){f=function(){function a(a,b,c){babelHelpers.classCallCheck(this,f),this.http=b,this.i18n=a,this.element=c,this.data="",this.closeInfos=[],this.self=this}babelHelpers.createClass(a,[{key:"activate",value:function(a){var b=this;return this.link=a.data,this.fetchIndex(),this.fetchData(this.link).then(function(){b.initializeComments(b.link)})}},{key:"attached",value:function(){}},{key:"fetchIndex",value:function(){var a=this;return this.http.fetch("data/index.json").then(function(a){return a.json()}).then(function(b){var c=b;a.currentDetails=e.find(c,function(b){return b.data==a.link});var d=new L.LatLng(a.currentDetails.pos[0],a.currentDetails.pos[1]);a.closeInfos=e.sortBy(c,function(a){var b=new L.LatLng(a.pos[0],a.pos[1]);return a.distance=d.distanceTo(b).toFixed(0),parseInt(a.distance)})})}},{key:"fetchData",value:function(a){var b=this,c=new Remarkable({html:!0});return this.http.fetch("data/full/"+a+".md").then(function(a){return a.text()}).then(function(a){var d=c.render(a);d=b.adjustMedia(d),b.data=d})}},{key:"initializeComments",value:function(a){window.cackle_widget=[],window.cackle_widget.push({widget:"Comment",id:43259,channel:a});var b=document.createElement("script");b.type="text/javascript",b.async=!0,b.src=("https:"==document.location.protocol?"https":"http")+"://cackle.me/widget.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c.nextSibling)}},{key:"adjustMedia",value:function(a){var b=$("<div>"+a+"</div>");return b.find("img").addClass("img-responsive img-thumbnail"),b.find("iframe").addClass("embed-responsive-item iframe-thumbnail"),b.find("iframe").wrap('<div class="embed-responsive embed-responsive-16by9"></div>'),b.html()}}]);var f=a;return a=c(d,b,Element)(a)||a}(),a("Details",f)}}}),function(){var a=System.amdDefine;a("components/map.html!github:systemjs/plugin-text@0.0.4.js",[],function(){return'<template> <div id="map"></div> </template>'})}(),System.register("components/map.js",["lodash","fetch","aurelia-fetch-client","aurelia-framework","aurelia-i18n"],function(a){"use strict";var b,c,d,e,f;return{setters:[function(a){b=a["default"]},function(a){},function(a){c=a.HttpClient},function(a){d=a.inject},function(a){e=a.I18N}],execute:function(){f=function(){function a(a,b,c){babelHelpers.classCallCheck(this,f),this.self=this,self.http=b,self.i18bn=a,this.element=c}babelHelpers.createClass(a,[{key:"fetchMarkers",value:function(a,c){var d=this,e=new L.MarkerClusterGroup;b.forEach(a,function(a){var b=L.marker(new L.LatLng(a.pos[0],a.pos[1]),{icon:L.mapbox.marker.icon({"marker-symbol":a.marker,"marker-color":a.color,"marker-size":"large"}),title:"index"}),c=new Remarkable({html:!0});self.http.fetch("data/thumbs/"+a.data+".md").then(function(a){return a.text()}).then(function(f){var g=c.render(f);g=d.adjustMedia(g),b.bindPopup('<div class="marker-thumb">'+g+'</div><div class="text-right"><a href="/#/'+a.data+'" class="btn btn-default">'+self.i18bn.i18next.t("map.marker.readMore")+"</a></div>"),e.addLayer(b)})}),c.addLayer(e)}},{key:"fetchIndex",value:function(a){var b=this;self.http.fetch("data/index.json").then(function(a){return a.json()}).then(function(c){b.fetchMarkers(c,a)})}},{key:"adjustMedia",value:function(a){var b=$("<div>"+a+"</div>");return b.find("img").addClass("img-responsive img-thumbnail"),b.find("iframe").addClass("embed-responsive-item iframe-thumbnail"),b.find("iframe").wrap('<div class="embed-responsive embed-responsive-16by9"></div>'),b.html()}},{key:"attached",value:function(){L.mapbox.accessToken="pk.eyJ1Ijoic2VyZ2V5c2VkZWxuaWtvdiIsImEiOiJjaW05NzZucDEwMDBnd2RtOGo0N3U4YTJ4In0.BnhUwye9rhjh9z2124wkQA",self.map=L.mapbox.map("map","mapbox.streets").setView([57.15,65.53333],11),this.fetchIndex(self.map)}}]);var f=a;return a=d(e,c,Element)(a)||a}(),a("Map",f)}}});